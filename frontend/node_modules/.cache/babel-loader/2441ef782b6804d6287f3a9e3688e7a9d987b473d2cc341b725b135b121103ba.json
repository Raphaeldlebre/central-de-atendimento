{"ast":null,"code":"import _objectSpread from\"C:/Users/PICHAU/Documents/Central de Atendimento/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{listCampaigns,listHistory}from'../api';import*as XLSX from'xlsx';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const card={background:'#0F172A',border:'1px solid #1F2937',borderRadius:12,padding:20,marginBottom:16};const input={background:'#0B1220',border:'1px solid #27324A',color:'#E4E8EE',padding:'10px 12px',borderRadius:8};export default function HistoryView(){const[campaigns,setCampaigns]=useState([]);const[selected,setSelected]=useState('');const[rows,setRows]=useState([]);useEffect(()=>{listCampaigns().then(setCampaigns).catch(()=>{});},[]);useEffect(()=>{if(!selected)return;listHistory(selected).then(setRows).catch(()=>{});},[selected]);const exportExcel=()=>{const ws=XLSX.utils.json_to_sheet(rows);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'histórico');XLSX.writeFile(wb,\"historico_\".concat(selected||'all',\".xlsx\"));};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{style:card,children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,alignItems:'center',marginBottom:12},children:[/*#__PURE__*/_jsxs(\"select\",{value:selected,onChange:e=>setSelected(e.target.value),style:_objectSpread({},input),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecione uma campanha\\u2026\"}),campaigns.map(c=>/*#__PURE__*/_jsxs(\"option\",{value:c.id,children:[c.id.slice(0,8),\" \\xB7 \",c.type,\" \\xB7 \",new Date(c.created_at).toLocaleString()]},c.id))]}),/*#__PURE__*/_jsx(\"button\",{onClick:exportExcel,style:{background:'#1F2937',border:'1px solid #2F3B52',color:'#E4E8EE',padding:'10px 14px',borderRadius:8,cursor:'pointer'},children:\"Exportar Excel\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{overflow:'auto'},children:/*#__PURE__*/_jsxs(\"table\",{style:{width:'100%',borderCollapse:'collapse'},children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{style:{textAlign:'left',color:'#94A3B8'},children:[/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 10px',borderBottom:'1px solid #243146'},children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 10px',borderBottom:'1px solid #243146'},children:\"Batch\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 10px',borderBottom:'1px solid #243146'},children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 10px',borderBottom:'1px solid #243146'},children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 10px',borderBottom:'1px solid #243146'},children:\"Enviados\"}),/*#__PURE__*/_jsx(\"th\",{style:{padding:'8px 10px',borderBottom:'1px solid #243146'},children:\"Erro\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[rows.map(r=>{var _r$total,_r$sent,_r$error;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 10px',borderBottom:'1px solid #1F2937'},children:new Date(r.created_at).toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 10px',borderBottom:'1px solid #1F2937'},children:r.batch_id||'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 10px',borderBottom:'1px solid #1F2937'},children:r.status||'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 10px',borderBottom:'1px solid #1F2937'},children:(_r$total=r.total)!==null&&_r$total!==void 0?_r$total:'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 10px',borderBottom:'1px solid #1F2937'},children:(_r$sent=r.sent)!==null&&_r$sent!==void 0?_r$sent:'-'}),/*#__PURE__*/_jsx(\"td\",{style:{padding:'8px 10px',borderBottom:'1px solid #1F2937'},children:(_r$error=r.error)!==null&&_r$error!==void 0?_r$error:'-'})]},r.id);}),!rows.length&&/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",style:{padding:'12px 10px',color:'#94A3B8'},children:\"Sem registros.\"})})]})]})})]})});}","map":{"version":3,"names":["React","useEffect","useState","listCampaigns","listHistory","XLSX","jsx","_jsx","jsxs","_jsxs","card","background","border","borderRadius","padding","marginBottom","input","color","HistoryView","campaigns","setCampaigns","selected","setSelected","rows","setRows","then","catch","exportExcel","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","writeFile","concat","children","style","display","gap","alignItems","value","onChange","e","target","_objectSpread","map","c","id","slice","type","Date","created_at","toLocaleString","onClick","cursor","overflow","width","borderCollapse","textAlign","borderBottom","r","_r$total","_r$sent","_r$error","batch_id","status","total","sent","error","length","colSpan"],"sources":["C:/Users/PICHAU/Documents/Central de Atendimento/frontend/src/campaign/HistoryView.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { listCampaigns, listHistory } from '../api';\nimport * as XLSX from 'xlsx';\nconst card={background:'#0F172A',border:'1px solid #1F2937',borderRadius:12,padding:20,marginBottom:16};\nconst input={background:'#0B1220',border:'1px solid #27324A',color:'#E4E8EE',padding:'10px 12px',borderRadius:8};\nexport default function HistoryView(){\n  const [campaigns,setCampaigns]=useState([]);\n  const [selected,setSelected]=useState('');\n  const [rows,setRows]=useState([]);\n  useEffect(()=>{ listCampaigns().then(setCampaigns).catch(()=>{}); },[]);\n  useEffect(()=>{ if(!selected) return; listHistory(selected).then(setRows).catch(()=>{}); },[selected]);\n  const exportExcel=()=>{ const ws=XLSX.utils.json_to_sheet(rows); const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb,ws,'histórico'); XLSX.writeFile(wb,`historico_${selected||'all'}.xlsx`); };\n  return (<div>\n    <div style={card}>\n      <div style={{display:'flex',gap:12,alignItems:'center',marginBottom:12}}>\n        <select value={selected} onChange={e=>setSelected(e.target.value)} style={{...input}}>\n          <option value=''>Selecione uma campanha…</option>\n          {campaigns.map(c=>(<option key={c.id} value={c.id}>{c.id.slice(0,8)} · {c.type} · {new Date(c.created_at).toLocaleString()}</option>))}\n        </select>\n        <button onClick={exportExcel} style={{background:'#1F2937', border:'1px solid #2F3B52', color:'#E4E8EE', padding:'10px 14px', borderRadius:8, cursor:'pointer'}}>Exportar Excel</button>\n      </div>\n      <div style={{overflow:'auto'}}>\n        <table style={{width:'100%', borderCollapse:'collapse'}}>\n          <thead><tr style={{textAlign:'left', color:'#94A3B8'}}>\n            <th style={{padding:'8px 10px',borderBottom:'1px solid #243146'}}>Data</th>\n            <th style={{padding:'8px 10px',borderBottom:'1px solid #243146'}}>Batch</th>\n            <th style={{padding:'8px 10px',borderBottom:'1px solid #243146'}}>Status</th>\n            <th style={{padding:'8px 10px',borderBottom:'1px solid #243146'}}>Total</th>\n            <th style={{padding:'8px 10px',borderBottom:'1px solid #243146'}}>Enviados</th>\n            <th style={{padding:'8px 10px',borderBottom:'1px solid #243146'}}>Erro</th>\n          </tr></thead>\n          <tbody>\n            {rows.map(r=>(<tr key={r.id}>\n              <td style={{padding:'8px 10px',borderBottom:'1px solid #1F2937'}}>{new Date(r.created_at).toLocaleString()}</td>\n              <td style={{padding:'8px 10px',borderBottom:'1px solid #1F2937'}}>{r.batch_id||'-'}</td>\n              <td style={{padding:'8px 10px',borderBottom:'1px solid #1F2937'}}>{r.status||'-'}</td>\n              <td style={{padding:'8px 10px',borderBottom:'1px solid #1F2937'}}>{r.total??'-'}</td>\n              <td style={{padding:'8px 10px',borderBottom:'1px solid #1F2937'}}>{r.sent??'-'}</td>\n              <td style={{padding:'8px 10px',borderBottom:'1px solid #1F2937'}}>{r.error??'-'}</td>\n            </tr>))}\n            {!rows.length&&(<tr><td colSpan='6' style={{padding:'12px 10px',color:'#94A3B8'}}>Sem registros.</td></tr>)}\n          </tbody>\n        </table>\n      </div>\n    </div></div>);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}